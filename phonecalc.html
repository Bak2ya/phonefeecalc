<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>통신비 계산기 by Bak2ya</title>

    <style>
      /*input type number 에서 옆에 스핀버튼 안나오게 하기*/
      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      /*입력 받는곳 모양*/
      .costcalc input[type="text"],
      .costcalc input[type="number"]{
        border: 0px; /*테두리 없애기*/
        border-bottom: 1px solid #999; /*테두리 없애고 밑줄만 그리기*/
        outline-style: none; /*클릭했을때 테두리 없애기*/
      }
      /*id,name에 맞게 입력창 크기 유지*/
      #phone{width:5em;}
      .months{width:2em;}
      .cost{width:4em;}
    </style>

    <script>
    //필요한거: 모든칸이 입력되지 않고 [계산하기]를 누를경우 모든 창을 채워달라는 alert 메시지 표시
    // https://runtoyourdream.tistory.com/203
      function calc(){
        //일단 입력받는 값들 다 var로 지정하기
        var tablename =document.getElementById("tablename").value;
        var phone     =document.getElementById("phone").value;
        var plan      =document.getElementById("plan").value;
        //선약 체크박스 확인하고 true=0.75,  false=1로 하는 수식
        var choice25  =document.getElementById("choice25").checked;
        var choice;
        if(choice25 == true){
          choice = '0.75';
          }else{choice = '1';}
        var period    =document.querySelector('input[name="period"]:checked').value;
        //계약기간 24일경우 24, 36인경우 36입력받음.
        //radio 선택에 따라 value값을 받아 period에 저장.
        var planmonth =document.getElementById("planmonth").value;
        var afterplan =document.getElementById("afterplan").value;
        var discount =document.querySelector('input[name="discount"]:checked').value;
        //추가할인은 SKT온가족할인 기준 없을때 1, 있을때 각각 0.9, 0.7을 입력받음
        var bu1       =document.getElementById("bu1").value;
        var bu1m      =document.getElementById("bu1m").value;
        var bu2       =document.getElementById("bu2").value;
        var bu2m      =document.getElementById("bu2m").value;

        // 모든 필드 입력여부 확인
        theForm = document.costcalc;
        if(theForm.tablename.value=="" || theForm.phone.value=="" || theForm.plan.value=="" || theForm.planmonth.value=="" || theForm.afterplan.value=="" || theForm.bu1.value=="" || theForm.bu1m.value=="" || theForm.bu2.value=="" || theForm.bu2m.value==""){
          if(theForm.tablename.value==""){// 고민: 이렇게 반복되는 내용을 줄일 수 있는 방법은 없을까?
            alert("견적명을 입력해 주세요")
    				theForm.tablename.focus();
          }else if (theForm.phone.value=="") {
            alert("할부원금을 입력해 주세요")
    				theForm.phone.focus();
          }else if (theForm.plan.value=="") {
            alert("요금제를 입력해 주세요")
    				theForm.plan.focus();
          }else if (theForm.planmonth.value=="") {
            alert("요금제 필수 기간을 입력해 주세요")
    				theForm.planmonth.focus();
          }else if (theForm.afterplan.value=="") {
            alert("필수기간 이후 요금제를 입력해 주세요")
    				theForm.afterplan.focus();
          }else if (theForm.bu1.value=="") {
            alert("첫 번째 부가서비스 요금을 입력해 주세요")
    				theForm.bu1.focus();
          }else if (theForm.bu1m.value=="") {
            alert("첫 번째 부가서비스 기간을 입력해 주세요")
    				theForm.bu1m.focus();
          }else if (theForm.bu2.value=="") {
            alert("두 번째 부가서비스 요금을 입력해 주세요")
    				theForm.bu2.focus();
          }else {
            alert("두 번째 부가서비스 기간을 입력해 주세요")
    				theForm.bu2m.focus();
          }
        }else {//모든 필드 입력된 경우 계산 실행
          var plancost  = (parseInt(plan)*parseInt(planmonth) + parseInt(afterplan)*(parseInt(period)-parseInt(planmonth)))*parseFloat(discount)*parseFloat(choice);
          //통신요금: (필수요금제*필수기간 + 이후 요금제*잔여기간(계약기간-필수기간))*온가족*선약

          var totalbu   = parseInt(bu1) * parseInt(bu1m) + parseInt(bu2) * parseInt(bu2m);
          //부가서비스: (부가요금*부가기간)+(부가요금*부가기간)

          var total     = parseInt(phone) + parseFloat(plancost) + parseInt(totalbu);
          var totalavg  = parseFloat(total) / parseInt(period);
          //최종계산: (할부원금 + 통신요금 + 부가서비스)= 총비용. 월비용 : 총비용/계약기간
          var plancostavg = parseFloat(plancost) / parseInt(period);

          // 소수점 나오는거 조절은 toFixed(소수점자리수)로 나타낸다

          document.getElementById('answer').innerHTML = '견적 : ' + tablename + '<br>'
          + '총 비용' + parseFloat(total).toFixed(2) + '원' + '(월 평균' + parseFloat(totalavg).toFixed(2) + '원)' + '<br>' + '할부 원금'+ phone +'원, 통신요금 총 '+ plancost +'원. (월'+plancostavg.toFixed(2)+'원)'+'<br>';
          /*
          document.write('견적 : ' + tablename + '<br>');
          document.write('총 비용' + parseFloat(total).toFixed(2) + '원');
          document.write('(월 평균' + parseFloat(totalavg).toFixed(2) + '원)' + '<br>');
          document.write('할부 원금'+ phone +'원, 통신요금 총 '+ plancost +'원. (월'+plancostavg.toFixed(2)+'원'+'<br>'));
          이걸로 하면 될줄 알았으나, document.write()는 내용 다 지우고 쓰는거라 쓰면 안된다.*/

          /*계산하기 버튼 누를때 출력하고싶은 내용
          견적 : tablename
          총 비용 parseFloat(total).toFixed(2) 원  월 평균 parseFloat(totalavg).toFixed(2)원
          할부원금 phone 원   통신요금 총 plancost 원 (월 plancostavg.toFixed(2)원)
          */

          // TODO: 계산하기를 누르면 데이터가 누적되게 하고싶음.
        }
      }

    </script>
  </head>

<body>
  <h1> 통신비 계산기</h1>
  <p>
    이 계산기는 단순 참고용 입니다.<br>
    할부원금과 사용 요금제를 통해 총 소비 요금과 월 평균 비용을 계산할 수 있습니다.<br>
  </p>
  <form name='costcalc'>
    견적명 <input type="text" id="tablename" size="20" placeholder="견적명 입력"><br><br>

    할부원금 <input type="number" id="phone">원<br><br>

    요금제 <input type="number" id="plan" class="cost" value="89000">원
    (<label><input type="checkbox" id="choice25">
    선택약정)</label><br><br>

    계약기간
    <label><input type='radio' name='period' value='24' checked>24개월</label>
    <label><input type='radio' name='period' value='36'>36개월</label><br><br>

    요금제 필수 기간 : <input type="number" id="planmonth" value="6" class="months">개월<br><br>

    필수기간이후 요금제 : <input type="number" id="afterplan" class="cost">원<br><br>
    추가 할인
    <label><input type="radio" name="discount" value="1" checked>없음</label>
    <label><input type="radio" name="discount" value="0.9">SKT 온가족 10%</label>
    <label><input type="radio" name="discount" value="0.7">SKT 온가족 30%</label>
    <br><br>

    부가서비스<br><br>
    1. <input type="number" id="bu1" value="0" class="cost">원
       <input type="number" id="bu1m" value="0" class="months">개월<br><br>
    2. <input type="number" id="bu2" value="0" class="cost">원
       <input type="number" id="bu2m" value="0" class="months">개월<br><br>
    </form>

    <br>
    <button type="button" onclick="calc()">계산하기</button><br><br>
    <div id="answer"></div>

</body>
</html>
<!--고민할거: SKT이외 추가할인 적용을 어떻게 할것인가. -->
